import{loadHeaderFooter as x,loadFavorites as A}from"./util-DDZ2ozR1.js";import{b as R,P as p}from"./PlaceDetails-DsYDr_P2.js";import{a as S,c as q}from"./cardRenderer-Cg7Vpnng.js";let c=[],l=[];const f=6;let m=0;async function b(){const n=A(),o=p._internal&&p._internal.attractions?p._internal.attractions:[],d=p._internal&&p._internal.restaurants?p._internal.restaurants:[];async function e(i){let a=o.find(u=>u.placeId===i)||d.find(u=>u.placeId===i);if(a)return a;try{return a=await p.getPlaceById(i),a}catch(u){return console.warn("Failed to fetch favorite detail",i,u),null}}const t=[];for(const i of n.destinations){const a=await e(i);a&&t.push(a)}c=t;const s=[];for(const i of n.restaurants){const a=await e(i);a&&s.push(a)}l=s}function I(){const n=document.querySelector("#regions");if(!n)return;n.innerHTML="";const o=document.createElement("option");o.value="All",o.textContent="All Regions",n.appendChild(o),Object.keys(p.groupByRegion([...c,...l])).forEach(e=>{const t=document.createElement("option");t.value=e,t.textContent=e,n.appendChild(t)})}function h(){const n=document.querySelector(".destinations-module .container"),o=document.querySelector(".restaurants-module .container"),d=document.querySelector(".no-favorites-message");if(d&&d.remove(),n){if(n.innerHTML="",m=0,!c||c.length===0){const e=document.createElement("div");e.className="no-favorites-message",e.textContent="No favorites saved",n.appendChild(e)}else c.slice(0,f).forEach(t=>{const s=S(t,{onFiltersReapply:h});n.appendChild(s)});if(c.length>f){let e=document.querySelector("#show-more-fav-dest");e||(e=document.createElement("button"),e.id="show-more-fav-dest",e.className="show-more",e.textContent="Show more",e.addEventListener("click",()=>{m++;const t=m*f,s=Math.min(c.length,(m+1)*f);c.slice(t,s).forEach(a=>{const u=S(a,{onFiltersReapply:h});n.appendChild(u)}),(m+1)*f>=c.length&&e.remove()}),n.parentElement.appendChild(e))}}if(o){if(o.innerHTML="",m=0,!l||l.length===0){const e=document.createElement("div");e.className="no-favorites-message",e.textContent="No favorites saved",o.appendChild(e)}else l.slice(0,f).forEach(t=>{const s=q(t,{onFiltersReapply:h});o.appendChild(s)});if(l.length>f){let e=document.querySelector("#show-more-fav-rest");e||(e=document.createElement("button"),e.id="show-more-fav-rest",e.className="show-more",e.textContent="Show more",e.addEventListener("click",()=>{m++;const t=m*f,s=Math.min(l.length,(m+1)*f);l.slice(t,s).forEach(a=>{const u=q(a,{onFiltersReapply:h});o.appendChild(u)}),(m+1)*f>=l.length&&e.remove()}),o.parentElement.appendChild(e))}}}function M(){const n=document.querySelectorAll("a.explore.button");!n||n.length===0||n.forEach(o=>{o.addEventListener("click",d=>{const e=document.querySelector("#regions"),t=e?e.value:"All",s=R(o.href,t);d.preventDefault(),location.href=s})})}document.addEventListener("DOMContentLoaded",async()=>{x(),M(),await b(),I(),h();const n=document.querySelector("#searchbar");n&&n.addEventListener("input",()=>d()),document.querySelectorAll('input[name="status"]').forEach(e=>e.addEventListener("change",()=>d()));const o=document.querySelector("#regions");o&&o.addEventListener("change",()=>d());function d(){var y,C,E,w,L;const e=(E=(C=(y=document.querySelector("#searchbar"))==null?void 0:y.value)==null?void 0:C.toLowerCase())==null?void 0:E.trim(),t=((w=document.querySelector('input[name="status"]:checked'))==null?void 0:w.value)||"all",s=((L=document.querySelector("#regions"))==null?void 0:L.value)||"All",i=c.filter(r=>{if(s!=="All"&&r.region!==s||t!=="all"&&(t==="open"&&(typeof r.isOpen=="boolean"?!r.isOpen:!(r.status||"").toLowerCase().includes("operational"))||t==="closed"&&(typeof r.isOpen=="boolean"?r.isOpen:!(r.status||"").toLowerCase().includes("closed"))))return!1;if(e){const v=(r.name||"").toLowerCase(),g=(r.types||[]).join(" ").toLowerCase();if(!v.includes(e)&&!g.includes(e))return!1}return!0}),a=l.filter(r=>{if(s!=="All"&&r.region!==s||t!=="all"&&(t==="open"&&!(r.status||"").toLowerCase().includes("operational")||t==="closed"&&!(r.status||"").toLowerCase().includes("closed")))return!1;if(e){const v=(r.name||"").toLowerCase(),g=(r.types||[]).join(" ").toLowerCase();if(!v.includes(e)&&!g.includes(e))return!1}return!0}),u=c,F=l;c=i,l=a,h(),c=u,l=F}});
