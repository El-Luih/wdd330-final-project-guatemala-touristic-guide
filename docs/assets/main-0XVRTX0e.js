import{loadHeaderFooter as b,isFavorite as h,toggleFavorite as f}from"./util-DDZ2ozR1.js";import{g as E,P as v,a as y,r as L,R as w,b as R,c as x,d as F,D as C}from"./RestaurantDetails-Cqs_NGMq.js";const S=function(){const e="https://api.open-meteo.com/v1/forecast";async function a(o,n){const c=`${e}?latitude=${encodeURIComponent(o)}&longitude=${encodeURIComponent(n)}&daily=temperature_2m_max,temperature_2m_min,weathercode&timezone=auto`,r=await fetch(c);if(!r.ok)throw new Error("OpenMeteo fetch failed: "+r.status);return r.json()}return{fetchDaily:a}}();function T(e){try{if(!e||!e.daily)return null;const{time:a,temperature_2m_max:o,temperature_2m_min:n,weathercode:c}=e.daily;return Array.isArray(a)?a.map((r,i)=>({date:r,max:(o==null?void 0:o[i])??null,min:(n==null?void 0:n[i])??null,code:(c==null?void 0:c[i])??null})):null}catch(a){return console.error("dailySummary: failed to parse OpenMeteo response",a),null}}const N={0:"clear.svg",1:"mainly_clear.svg",2:"partly_cloudy.svg",3:"overcast.svg",45:"fog.svg",48:"depositing_rime_fog.svg",51:"drizzle_light.svg",53:"drizzle_moderate.svg",55:"drizzle_dense.svg",61:"rain_light.svg",63:"rain_moderate.svg",65:"rain_heavy.svg",71:"snow_light.svg",73:"snow_moderate.svg",75:"snow_heavy.svg",80:"rain_showers_light.svg",81:"rain_showers_moderate.svg",82:"rain_showers_violent.svg"};function D(e){return`${e.toFixed(1)}°C`}async function A(e,a,o="Guatemala"){try{const n=await S.fetchDaily(e,a),c=T(n);if(!c)return;const r=["weather-0","weather-1","weather-2"];for(let d=0;d<3;d++){const t=document.getElementById(r[d]);if(!t)continue;const s=c[d];if(t.innerHTML="",!s)continue;const m=d===0?"Today":d===1?"Tomorrow":new Date(s.date).toLocaleDateString(void 0,{weekday:"long"}),l=document.createElement("h4");l.textContent=m;const p=document.createElement("img"),u=N[s.code]||"clear.svg";p.src=`/images/weather/${u}`,p.alt="weather",p.width=48,p.height=48;const g=document.createElement("div");g.textContent=D(s.max),t.appendChild(l),t.appendChild(p),t.appendChild(g)}const i=document.getElementById("weather-region");i&&(i.textContent=o)}catch(n){console.error("Weather fetch failed",n)}}function _(e){if(!e||e==="All")return C.center;const a=w[e];return a?a.center:C.center}function I(){const e=document.querySelector(".filtering-buttons");if(!e)return;e.innerHTML="";const a=document.createElement("button");a.dataset.region="All",a.textContent="All",e.appendChild(a),Object.keys(w).forEach(n=>{const c=document.createElement("button");c.dataset.region=n,c.textContent=n,e.appendChild(c)});let o="All";try{const n=E();n&&(o=n)}catch{}R(o),e.addEventListener("click",n=>{const c=n.target.closest("button");if(!c)return;const r=c.dataset.region||"All";try{const i=x(location.href,r);location.href=i}catch{document.querySelectorAll(".filtering-buttons button").forEach(t=>t.classList.toggle("current",t.dataset.region===r));const d=_(r);A(d.lat,d.lng,r==="All"?"Guatemala":r)}})}function B(e){try{document.querySelectorAll(".filtering-buttons button").forEach(a=>a.classList.toggle("current",a.dataset.region===(e||"All")))}catch{}}function k(){const e=document.querySelectorAll("a.explore.button");!e||e.length===0||e.forEach(a=>{a.addEventListener("click",o=>{const n=F(),c=x(a.href,n);o.preventDefault(),location.href=c})})}document.addEventListener("DOMContentLoaded",()=>{b(),I();let e="All";try{const o=E();o&&(e=o)}catch{}B(e),k();const a=_(e);A(a.lat,a.lng,e==="All"?"Guatemala":e),(async()=>{try{const o=e||"All",[n,c]=await Promise.all([v.fetchAttractionsForRegion(o,6),v.fetchRestaurantsForRegion(o,6)]),r=document.querySelector(".destinations.container");r&&(r.innerHTML="",(n||[]).slice(0,6).forEach(d=>{const t=y(d),s=document.createElement("article");s.className="small-card";const m=document.createElement("div");m.className="card-media ratio-2x1";const l=document.createElement("img");l.src=t.image,l.alt=t.name,l.onerror=()=>{const g="/wdd330-final-project-guatemala-touristic-guide/";l.src=`${g}images/placeholder-2x1.svg`},m.appendChild(l),s.appendChild(m);const p=document.createElement("h4");p.textContent=t.name,s.appendChild(p);const u=document.createElement("button");u.type="button",u.className="fav-button",u.textContent=h(t.id,"destination")?"★":"☆",u.addEventListener("click",g=>{g.preventDefault(),g.stopPropagation(),f(t.id,"destination"),u.textContent=h(t.id,"destination")?"★":"☆"}),s.appendChild(u),r.appendChild(s)}));const i=document.querySelector(".restaurants.container");i&&(i.innerHTML="",(c||[]).slice(0,6).forEach(d=>{const t=L(d),s=document.createElement("article");s.className="small-card";const m=document.createElement("div");m.className="card-media ratio-1x1";const l=document.createElement("img");l.src=t.logo,l.alt=t.name,l.onerror=()=>{const g="/wdd330-final-project-guatemala-touristic-guide/";l.src=`${g}images/restaurant-placeholder-1x1.svg`},m.appendChild(l),s.appendChild(m);const p=document.createElement("h4");p.textContent=t.name,s.appendChild(p);const u=document.createElement("button");u.type="button",u.className="fav-button",u.textContent=h(t.id,"restaurant")?"★":"☆",u.addEventListener("click",g=>{g.preventDefault(),g.stopPropagation(),f(t.id,"restaurant"),u.textContent=h(t.id,"restaurant")?"★":"☆"}),s.appendChild(u),i.appendChild(s)}))}catch(o){console.warn("Failed rendering main page gadgets",o)}})(),(async()=>{try{const o=await v.fetchAttractionsForRegion("All",18),n=document.querySelector(".destinations.container");if(!n)return;n.innerHTML="",o.slice(0,6).forEach(c=>{const r=y(c),i=document.createElement("article");i.className="small-card";const d=document.createElement("div");d.className="card-media ratio-2x1";const t=document.createElement("img");t.src=r.image,t.alt=r.name,t.onerror=()=>{const l="/wdd330-final-project-guatemala-touristic-guide/";t.src=`${l}images/placeholder-2x1.svg`},d.appendChild(t),i.appendChild(d);const s=document.createElement("h4");s.textContent=r.name,i.appendChild(s);const m=document.createElement("button");m.type="button",m.className="fav-button",m.textContent=h(r.id,"destination")?"★":"☆",m.addEventListener("click",l=>{l.preventDefault(),l.stopPropagation(),f(r.id,"destination"),m.textContent=h(r.id,"destination")?"★":"☆"}),i.appendChild(m),n.appendChild(i)})}catch(o){console.warn("Failed rendering featured destinations",o)}})()});
