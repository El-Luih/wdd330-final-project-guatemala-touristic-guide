import{loadHeaderFooter as M,isFavorite as h,toggleFavorite as f}from"./util-DDZ2ozR1.js";import{g as w,P as v,a as C,r as N,R as D,b as S,c as x,d as L,D as y}from"./RestaurantDetails-Cqs_NGMq.js";const F=function(){const e="https://api.open-meteo.com/v1/forecast";async function a(o,s){const d=`${e}?latitude=${encodeURIComponent(o)}&longitude=${encodeURIComponent(s)}&daily=temperature_2m_max,temperature_2m_min,weathercode&timezone=auto`,c=await fetch(d);if(!c.ok)throw new Error("OpenMeteo fetch failed: "+c.status);return c.json()}return{fetchDaily:a}}();function T(e){try{if(!e||!e.daily)return null;const{time:a,temperature_2m_max:o,temperature_2m_min:s,weathercode:d}=e.daily;return Array.isArray(a)?a.map((c,g)=>({date:c,max:(o==null?void 0:o[g])??null,min:(s==null?void 0:s[g])??null,code:(d==null?void 0:d[g])??null})):null}catch(a){return console.error("dailySummary: failed to parse OpenMeteo response",a),null}}const R={0:"clear.svg",1:"mainly_clear.svg",2:"partly_cloudy.svg",3:"overcast.svg",45:"fog.svg",48:"depositing_rime_fog.svg",51:"drizzle_light.svg",53:"drizzle_moderate.svg",55:"drizzle_dense.svg",56:"freezing_drizzle_light.svg",57:"freezing_drizzle_dense.svg",61:"rain_light.svg",63:"rain_moderate.svg",65:"rain_heavy.svg",66:"freezing_rain_light.svg",67:"freezing_rain_heavy.svg",71:"snow_light.svg",73:"snow_moderate.svg",75:"snow_heavy.svg",77:"snow_grains.svg",80:"rain_showers_light.svg",81:"rain_showers_moderate.svg",82:"rain_showers_violent.svg",85:"snow_showers_light.svg",86:"snow_showers_heavy.svg",95:"thunderstorm.svg",96:"thunderstorm_hail_light.svg",99:"thunderstorm_hail_heavy.svg"},b={BASE_URL:"/wdd330-final-project-guatemala-touristic-guide/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};function k(e){return`${e.toFixed(1)}°C`}async function j(e,a,o="Guatemala"){try{const s=await F.fetchDaily(e,a),d=T(s);if(!d)return;const c=["weather-0","weather-1","weather-2"];for(let u=0;u<3;u++){const i=document.getElementById(c[u]);if(!i)continue;const t=d[u];if(i.innerHTML="",!t)continue;const n=u===0?"Today":u===1?"Tomorrow":new Date(t.date).toLocaleDateString(void 0,{weekday:"long"}),l=document.createElement("h4");l.textContent=n;const m=document.createElement("img"),r=R[t.code]||"clear.svg",p=import.meta&&b?"/wdd330-final-project-guatemala-touristic-guide/":"/";m.src=`${p}images/weather/${r}`,m.alt="weather",m.width=48,m.height=48,m.onerror=()=>{m.src=`${p}images/weather/clear.svg`};const E=document.createElement("div");E.textContent=k(t.max),i.appendChild(l),i.appendChild(m),i.appendChild(E)}const g=document.getElementById("weather-region");g&&(g.textContent=o)}catch(s){console.error("Weather fetch failed",s)}}function A(e){if(!e||e==="All")return y.center;const a=D[e];return a?a.center:y.center}function $(){const e=document.querySelector(".filtering-buttons");if(!e)return;e.innerHTML="";const a=document.createElement("button");a.dataset.region="All",a.textContent="All",e.appendChild(a),Object.keys(D).forEach(s=>{const d=document.createElement("button");d.dataset.region=s,d.textContent=s,e.appendChild(d)});let o="All";try{const s=w();s&&(o=s)}catch{}S(o),e.addEventListener("click",s=>{const d=s.target.closest("button");if(!d)return;const c=d.dataset.region||"All";try{const g=x(location.href,c);location.href=g}catch{document.querySelectorAll(".filtering-buttons button").forEach(i=>i.classList.toggle("current",i.dataset.region===c));const u=A(c);j(u.lat,u.lng,c==="All"?"Guatemala":c)}})}function z(e){try{document.querySelectorAll(".filtering-buttons button").forEach(a=>a.classList.toggle("current",a.dataset.region===(e||"All")))}catch{}}function I(){const e=document.querySelectorAll("a.explore.button");!e||e.length===0||e.forEach(a=>{a.addEventListener("click",o=>{const s=L(),d=x(a.href,s);o.preventDefault(),location.href=d})})}document.addEventListener("DOMContentLoaded",()=>{M(),$();let e="All";try{const o=w();o&&(e=o)}catch{}z(e),I();const a=A(e);j(a.lat,a.lng,e==="All"?"Guatemala":e),(async()=>{try{const o=e||"All",[s,d]=await Promise.all([v.fetchAttractionsForRegion(o,6),v.fetchRestaurantsForRegion(o,6)]),c=document.querySelector(".destinations.container");c&&(c.innerHTML="",(s||[]).slice(0,6).forEach(u=>{const i=C(u),t=document.createElement("article");t.className="small-card";const n=document.createElement("div");n.className="card-media ratio-2x1";const l=document.createElement("img");l.src=i.image,l.alt=i.name,l.onerror=()=>{const p="/wdd330-final-project-guatemala-touristic-guide/";l.src=`${p}images/placeholder-2x1.svg`},n.appendChild(l),t.appendChild(n);const m=document.createElement("h4");m.textContent=i.name,t.appendChild(m);const r=document.createElement("button");r.type="button",r.className="fav-button",r.textContent=h(i.id,"destination")?"★":"☆",r.addEventListener("click",p=>{p.preventDefault(),p.stopPropagation(),f(i.id,"destination"),r.textContent=h(i.id,"destination")?"★":"☆"}),t.appendChild(r),c.appendChild(t)}));const g=document.querySelector(".restaurants.container");g&&(g.innerHTML="",(d||[]).slice(0,6).forEach(u=>{const i=N(u),t=document.createElement("article");t.className="small-card";const n=document.createElement("div");n.className="card-media ratio-1x1";const l=document.createElement("img");l.src=i.logo,l.alt=i.name,l.onerror=()=>{const p="/wdd330-final-project-guatemala-touristic-guide/";l.src=`${p}images/restaurant-placeholder-1x1.svg`},n.appendChild(l),t.appendChild(n);const m=document.createElement("h4");m.textContent=i.name,t.appendChild(m);const r=document.createElement("button");r.type="button",r.className="fav-button",r.textContent=h(i.id,"restaurant")?"★":"☆",r.addEventListener("click",p=>{p.preventDefault(),p.stopPropagation(),f(i.id,"restaurant"),r.textContent=h(i.id,"restaurant")?"★":"☆"}),t.appendChild(r),g.appendChild(t)}))}catch(o){console.warn("Failed rendering main page gadgets",o)}})(),(async()=>{try{const o=await v.fetchAttractionsForRegion("All",18),s=document.querySelector(".destinations.container");if(!s)return;s.innerHTML="",o.slice(0,6).forEach(d=>{const c=C(d),g=document.createElement("article");g.className="small-card";const u=document.createElement("div");u.className="card-media ratio-2x1";const i=document.createElement("img");i.src=c.image,i.alt=c.name,i.onerror=()=>{const l="/wdd330-final-project-guatemala-touristic-guide/";i.src=`${l}images/placeholder-2x1.svg`},u.appendChild(i),g.appendChild(u);const t=document.createElement("h4");t.textContent=c.name,g.appendChild(t);const n=document.createElement("button");n.type="button",n.className="fav-button",n.textContent=h(c.id,"destination")?"★":"☆",n.addEventListener("click",l=>{l.preventDefault(),l.stopPropagation(),f(c.id,"destination"),n.textContent=h(c.id,"destination")?"★":"☆"}),g.appendChild(n),s.appendChild(g)})}catch(o){console.warn("Failed rendering featured destinations",o)}})()});function _(e){if(!e)return null;const a=e.split("-").map(o=>o.padStart(2,"0"));return a.length!==2?null:{mm:parseInt(a[0],10),dd:parseInt(a[1],10)}}function O(e,a,o=new Date){const s=new Date(e.getFullYear(),e.getMonth(),e.getDate()),d=new Date(a.getFullYear(),a.getMonth(),a.getDate()),c=new Date(o.getFullYear(),o.getMonth(),o.getDate());return c<s?"upcoming":c>d?"past":"ongoing"}async function H(){const e=document.querySelector(".events.container.table");if(!e)return;const o=[`${import.meta&&b?"/wdd330-final-project-guatemala-touristic-guide/":"/"}json/guatemala-events.json`,"json/guatemala-events.json","/json/guatemala-events.json","/public/json/guatemala-events.json","/src/public/json/guatemala-events.json","../json/guatemala-events.json","./public/json/guatemala-events.json"];try{console.debug("Events JSON fetch candidates:",o)}catch{}let s=null;const d=[];for(const t of o)try{const n=await fetch(t);if(d.push({path:t,ok:n.ok,status:n.status}),!n.ok)continue;s=await n.json();break}catch(n){d.push({path:t,ok:!1,error:String(n)})}if(!s){e.innerHTML="";const t=document.createElement("div");t.className="no-events",t.textContent="No events this month",e.appendChild(t);const n=document.createElement("details");n.style.marginTop="10px";const l=document.createElement("summary");l.textContent="Debug: attempted event JSON paths (click to expand)",n.appendChild(l);const m=document.createElement("ul");d.forEach(r=>{const p=document.createElement("li");r.error?p.textContent=`${r.path} → error: ${r.error}`:p.textContent=`${r.path} → ok: ${r.ok} ${r.status?`(HTTP ${r.status})`:""}`,m.appendChild(p)}),n.appendChild(m),e.appendChild(n);try{console.warn("Events JSON fetch failed; attempted paths:",d)}catch{}return}const c=new Date,g=c.getMonth(),u=s.map(t=>{const n=_(t.date&&t.date.start),l=_(t.date&&t.date.end)||n,m=new Date(c.getFullYear(),n.mm-1,n.dd);let r=new Date(c.getFullYear(),l.mm-1,l.dd);r<m&&(r=new Date(r.getFullYear()+1,r.getMonth(),r.getDate()));const p=O(m,r,c);return{raw:t,startDate:m,endDate:r,status:p}}).filter(t=>t.startDate.getMonth()===g),i={ongoing:0,upcoming:1,past:2};if(u.sort((t,n)=>t.startDate-n.startDate!==0?t.startDate-n.startDate:i[t.status]-i[n.status]),e.innerHTML="",!u||u.length===0){const t=document.createElement("div");t.className="no-events",t.textContent="No events this month",e.appendChild(t);return}u.forEach(t=>{const n=document.createElement("article");n.className="mini-event-card",n.classList.add(`mini-event--${t.status}`);const l=document.createElement("div");l.className="mini-event__left";const m=document.createElement("div");m.className="mini-event__name",m.textContent=t.raw.name;const r=document.createElement("div");r.className="mini-event__date";const p=t.startDate;r.textContent=p.toLocaleDateString(void 0,{month:"short",day:"numeric"}),l.appendChild(m),l.appendChild(r),n.appendChild(l),e.appendChild(n)})}document.addEventListener("DOMContentLoaded",()=>{try{H()}catch(e){console.error("renderMainEventsGadget failed:",e);const a=document.querySelector(".events.container.table");if(a){a.innerHTML="";const o=document.createElement("div");o.className="no-events",o.textContent="Events could not be loaded (see console for details)",a.appendChild(o)}}});
