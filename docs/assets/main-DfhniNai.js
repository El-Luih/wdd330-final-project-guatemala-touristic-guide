import{loadHeaderFooter as b,isFavorite as p,toggleFavorite as f}from"./util-DDZ2ozR1.js";import{g as E,P as v,a as y,r as L,R as _,b as z,c as w,d as R,D as C}from"./RestaurantDetails-Cqs_NGMq.js";const F=function(){const e="https://api.open-meteo.com/v1/forecast";async function a(o,n){const i=`${e}?latitude=${encodeURIComponent(o)}&longitude=${encodeURIComponent(n)}&daily=temperature_2m_max,temperature_2m_min,weathercode&timezone=auto`,r=await fetch(i);if(!r.ok)throw new Error("OpenMeteo fetch failed: "+r.status);return r.json()}return{fetchDaily:a}}();function S(e){try{if(!e||!e.daily)return null;const{time:a,temperature_2m_max:o,temperature_2m_min:n,weathercode:i}=e.daily;return Array.isArray(a)?a.map((r,c)=>({date:r,max:(o==null?void 0:o[c])??null,min:(n==null?void 0:n[c])??null,code:(i==null?void 0:i[c])??null})):null}catch(a){return console.error("dailySummary: failed to parse OpenMeteo response",a),null}}const T={0:"clear.svg",1:"mainly_clear.svg",2:"partly_cloudy.svg",3:"overcast.svg",45:"fog.svg",48:"depositing_rime_fog.svg",51:"drizzle_light.svg",53:"drizzle_moderate.svg",55:"drizzle_dense.svg",56:"freezing_drizzle_light.svg",57:"freezing_drizzle_dense.svg",61:"rain_light.svg",63:"rain_moderate.svg",65:"rain_heavy.svg",66:"freezing_rain_light.svg",67:"freezing_rain_heavy.svg",71:"snow_light.svg",73:"snow_moderate.svg",75:"snow_heavy.svg",77:"snow_grains.svg",80:"rain_showers_light.svg",81:"rain_showers_moderate.svg",82:"rain_showers_violent.svg",85:"snow_showers_light.svg",86:"snow_showers_heavy.svg",95:"thunderstorm.svg",96:"thunderstorm_hail_light.svg",99:"thunderstorm_hail_heavy.svg"};function N(e){return`${e.toFixed(1)}°C`}async function x(e,a,o="Guatemala"){try{const n=await F.fetchDaily(e,a),i=S(n);if(!i)return;const r=["weather-0","weather-1","weather-2"];for(let d=0;d<3;d++){const t=document.getElementById(r[d]);if(!t)continue;const s=i[d];if(t.innerHTML="",!s)continue;const m=d===0?"Today":d===1?"Tomorrow":new Date(s.date).toLocaleDateString(void 0,{weekday:"long"}),l=document.createElement("h4");l.textContent=m;const h=document.createElement("img"),u=T[s.code]||"clear.svg";h.src=`/images/weather/${u}`,h.alt="weather",h.width=48,h.height=48;const g=document.createElement("div");g.textContent=N(s.max),t.appendChild(l),t.appendChild(h),t.appendChild(g)}const c=document.getElementById("weather-region");c&&(c.textContent=o)}catch(n){console.error("Weather fetch failed",n)}}function A(e){if(!e||e==="All")return C.center;const a=_[e];return a?a.center:C.center}function D(){const e=document.querySelector(".filtering-buttons");if(!e)return;e.innerHTML="";const a=document.createElement("button");a.dataset.region="All",a.textContent="All",e.appendChild(a),Object.keys(_).forEach(n=>{const i=document.createElement("button");i.dataset.region=n,i.textContent=n,e.appendChild(i)});let o="All";try{const n=E();n&&(o=n)}catch{}z(o),e.addEventListener("click",n=>{const i=n.target.closest("button");if(!i)return;const r=i.dataset.region||"All";try{const c=w(location.href,r);location.href=c}catch{document.querySelectorAll(".filtering-buttons button").forEach(t=>t.classList.toggle("current",t.dataset.region===r));const d=A(r);x(d.lat,d.lng,r==="All"?"Guatemala":r)}})}function I(e){try{document.querySelectorAll(".filtering-buttons button").forEach(a=>a.classList.toggle("current",a.dataset.region===(e||"All")))}catch{}}function B(){const e=document.querySelectorAll("a.explore.button");!e||e.length===0||e.forEach(a=>{a.addEventListener("click",o=>{const n=R(),i=w(a.href,n);o.preventDefault(),location.href=i})})}document.addEventListener("DOMContentLoaded",()=>{b(),D();let e="All";try{const o=E();o&&(e=o)}catch{}I(e),B();const a=A(e);x(a.lat,a.lng,e==="All"?"Guatemala":e),(async()=>{try{const o=e||"All",[n,i]=await Promise.all([v.fetchAttractionsForRegion(o,6),v.fetchRestaurantsForRegion(o,6)]),r=document.querySelector(".destinations.container");r&&(r.innerHTML="",(n||[]).slice(0,6).forEach(d=>{const t=y(d),s=document.createElement("article");s.className="small-card";const m=document.createElement("div");m.className="card-media ratio-2x1";const l=document.createElement("img");l.src=t.image,l.alt=t.name,l.onerror=()=>{const g="/wdd330-final-project-guatemala-touristic-guide/";l.src=`${g}images/placeholder-2x1.svg`},m.appendChild(l),s.appendChild(m);const h=document.createElement("h4");h.textContent=t.name,s.appendChild(h);const u=document.createElement("button");u.type="button",u.className="fav-button",u.textContent=p(t.id,"destination")?"★":"☆",u.addEventListener("click",g=>{g.preventDefault(),g.stopPropagation(),f(t.id,"destination"),u.textContent=p(t.id,"destination")?"★":"☆"}),s.appendChild(u),r.appendChild(s)}));const c=document.querySelector(".restaurants.container");c&&(c.innerHTML="",(i||[]).slice(0,6).forEach(d=>{const t=L(d),s=document.createElement("article");s.className="small-card";const m=document.createElement("div");m.className="card-media ratio-1x1";const l=document.createElement("img");l.src=t.logo,l.alt=t.name,l.onerror=()=>{const g="/wdd330-final-project-guatemala-touristic-guide/";l.src=`${g}images/restaurant-placeholder-1x1.svg`},m.appendChild(l),s.appendChild(m);const h=document.createElement("h4");h.textContent=t.name,s.appendChild(h);const u=document.createElement("button");u.type="button",u.className="fav-button",u.textContent=p(t.id,"restaurant")?"★":"☆",u.addEventListener("click",g=>{g.preventDefault(),g.stopPropagation(),f(t.id,"restaurant"),u.textContent=p(t.id,"restaurant")?"★":"☆"}),s.appendChild(u),c.appendChild(s)}))}catch(o){console.warn("Failed rendering main page gadgets",o)}})(),(async()=>{try{const o=await v.fetchAttractionsForRegion("All",18),n=document.querySelector(".destinations.container");if(!n)return;n.innerHTML="",o.slice(0,6).forEach(i=>{const r=y(i),c=document.createElement("article");c.className="small-card";const d=document.createElement("div");d.className="card-media ratio-2x1";const t=document.createElement("img");t.src=r.image,t.alt=r.name,t.onerror=()=>{const l="/wdd330-final-project-guatemala-touristic-guide/";t.src=`${l}images/placeholder-2x1.svg`},d.appendChild(t),c.appendChild(d);const s=document.createElement("h4");s.textContent=r.name,c.appendChild(s);const m=document.createElement("button");m.type="button",m.className="fav-button",m.textContent=p(r.id,"destination")?"★":"☆",m.addEventListener("click",l=>{l.preventDefault(),l.stopPropagation(),f(r.id,"destination"),m.textContent=p(r.id,"destination")?"★":"☆"}),c.appendChild(m),n.appendChild(c)})}catch(o){console.warn("Failed rendering featured destinations",o)}})()});
