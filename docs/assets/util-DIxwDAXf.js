(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function e(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=e(s);fetch(s.href,i)}})();async function v(){const a=document.getElementById("dynamic-header"),t=document.getElementById("dynamic-footer"),e="/wdd330-final-project-guatemala-touristic-guide/";try{const r=await fetch(`${e}/partials/header.html`),s=await fetch(`${e}/partials/footer.html`);try{console.log("loadHeaderFooter fetch",{header:{ok:r.ok,status:r.status},footer:{ok:s.ok,status:s.status}})}catch{}if(!r.ok||!s.ok)throw new Error("Partial not found");const i=await r.text(),l=await s.text();a.innerHTML=i,t.innerHTML=l,a.querySelector("#main-logo").setAttribute("src",`${e}/images/gtg-icon.svg`),a.querySelector("#header-banner").setAttribute("href",`${e}/index.html`),a.querySelector("#header-menu").querySelectorAll("a").forEach(function(o){const n=o.dataset.page;o.setAttribute("href",`${e}/${n}/index.html`),window.location.pathname.includes(n)&&o.classList.add("current")});try{const o=a.querySelector("#main-hamburger"),n=a.querySelector("#header-menu");if(o&&n){o.addEventListener("click",c=>{const y=n.classList.toggle("open");o.setAttribute("aria-expanded",y?"true":"false")}),document.addEventListener("click",c=>{if(!a.contains(c.target)){n.classList.contains("open")&&(n.classList.remove("open"),o.setAttribute("aria-expanded","false"));return}!n.contains(c.target)&&c.target!==o&&n.classList.contains("open")&&(n.classList.remove("open"),o.setAttribute("aria-expanded","false"))}),document.addEventListener("keydown",c=>{c.key==="Escape"&&n.classList.contains("open")&&(n.classList.remove("open"),o.setAttribute("aria-expanded","false"))});const u=window.matchMedia("(min-width: 800px)"),d=()=>{u.matches&&(n.classList.contains("open")&&n.classList.remove("open"),o.setAttribute("aria-expanded","false"))};try{typeof u.addEventListener=="function"?u.addEventListener("change",d):typeof u.addListener=="function"&&u.addListener(d)}catch{}d()}}catch(o){console.warn("Hamburger wiring failed",o)}}catch(r){console.error("Error loading partial: ",r)}}const E="AIzaSyA-Ip6-JCeCovgWWG6TijYI2SdLQdHTU84";class S{constructor(t){this.sourceURL=t,this.data}async getData(){try{const t=await fetch(this.sourceURL);try{console.log("ExternalData.getData response",{url:this.sourceURL,ok:t.ok,status:t.status})}catch{}if(!t.ok)return console.error(`ExternalData.getData: network error ${t.status} ${t.statusText} for ${this.sourceURL}`),null;let e;try{e=await t.clone().json();try{console.log("ExternalData.getData body",e)}catch{}}catch(s){return console.error(`ExternalData.getData: invalid JSON from ${this.sourceURL}:`,s),null}const r=e&&Object.prototype.hasOwnProperty.call(e,"Result")?e.Result:e;return r==null?(console.warn(`ExternalData.getData: no data returned from ${this.sourceURL}`),null):(this.data=r,this.data)}catch(t){return console.error(`ExternalData.getData: fetch failed for ${this.sourceURL}:`,t),null}}}const h="favoriteRestaurants_v1",m="favoriteDestinations_v1";function g(){try{const a=JSON.parse(localStorage.getItem(h)||"[]"),t=JSON.parse(localStorage.getItem(m)||"[]");return{restaurants:Array.isArray(a)?a:[],destinations:Array.isArray(t)?t:[]}}catch(a){return console.warn("loadFavorites: corrupt data, resetting",a),localStorage.removeItem(h),localStorage.removeItem(m),{restaurants:[],destinations:[]}}}function p({restaurants:a=[],destinations:t=[]}={}){localStorage.setItem(h,JSON.stringify(a)),localStorage.setItem(m,JSON.stringify(t))}function w(a,t="destination"){const e=g();return t==="restaurant"?e.restaurants.includes(a):e.destinations.includes(a)}function x(a,t="destination"){const e=g();if(t==="restaurant"){const r=new Set(e.restaurants);r.has(a)?r.delete(a):r.add(a),e.restaurants=Array.from(r)}else{const r=new Set(e.destinations);r.has(a)?r.delete(a):r.add(a),e.destinations=Array.from(r)}return p(e),e}function A(a,t=250){let e=null;return(...r)=>{e&&clearTimeout(e),e=setTimeout(()=>a(...r),t)}}class L{constructor(t=3,e=4,r=300){this.concurrency=t,this.queue=[],this.active=0,this.maxRetries=e,this.baseDelay=r}enqueue(t,e,r=0){return new Promise(s=>{this.queue.push({img:t,src:e,resolve:s,attempts:r}),this._next()})}_next(){if(this.active>=this.concurrency||this.queue.length===0)return;const t=this.queue.shift(),{img:e,src:r,resolve:s,attempts:i}=t;this.active++;let l=!1;const f=()=>n(!0),o=()=>n(!1),n=u=>{if(l)return;l=!0;try{e.removeEventListener("load",f),e.removeEventListener("error",o)}catch{}if(this.active--,setTimeout(()=>this._next(),0),u)return s(!0);const d=(i||0)+1;if(d<=this.maxRetries){const c=Math.round(this.baseDelay*Math.pow(2,d-1)+Math.random()*this.baseDelay);setTimeout(()=>{this.queue.push({img:e,src:r,resolve:s,attempts:d}),this._next()},c)}else s(!1)};e.addEventListener("load",f),e.addEventListener("error",o);try{e.src=r}catch{n(!1)}}}const b=new L(2,6,500);export{S as ExternalData,A as debounce,E as googleKey,b as imageLoader,w as isFavorite,g as loadFavorites,v as loadHeaderFooter,p as saveFavorites,x as toggleFavorite};
